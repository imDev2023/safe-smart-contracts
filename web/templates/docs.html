{% extends "base.html" %}

{% block title %}Documentation - Safe Smart Contracts{% endblock %}

{% block extra_css %}
<style>
    pre {
        background-color: #2d2d2d;
        border: 1px solid #444;
        border-radius: 6px;
        padding: 15px;
        overflow-x: auto;
    }

    pre code {
        color: #f8f8f2;
        font-family: 'Monaco', 'Courier New', monospace;
        font-size: 0.9rem;
        line-height: 1.5;
    }

    code {
        background-color: #f5f5f5;
        color: #d63384;
        padding: 2px 6px;
        border-radius: 3px;
        font-family: 'Monaco', 'Courier New', monospace;
    }

    pre code {
        background-color: transparent;
        color: #f8f8f2;
        padding: 0;
    }

    .card {
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }

    .card-body h5 {
        margin-top: 20px;
        margin-bottom: 10px;
        color: #374151;
        font-weight: 600;
    }

    .card-body h5:first-child {
        margin-top: 0;
    }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <div class="container-main">
        <h1 class="mb-4">
            <i class="fas fa-book text-primary"></i>
            Documentation
        </h1>

        <!-- Quick Start -->
        <div class="card mb-4">
            <div class="card-body">
                <h3><i class="fas fa-rocket"></i> Quick Start</h3>
                <h5>1. Search the Knowledge Base</h5>
                <p>Use the <a href="/search">Search</a> page to explore 284 files of security knowledge.</p>
                <pre><code>Examples:
- Search "reentrancy" to find all reentrancy-related content
- Click "Vulnerabilities" to see all documented exploits
- Filter by severity or loss amount</code></pre>

                <h5 class="mt-4">2. Generate a Contract</h5>
                <p>Use the <a href="/generate">Generate</a> page to create production-ready contracts.</p>
                <pre><code>Steps:
1. Select contract type (ERC20 or ERC721)
2. Choose domain (DeFi, Gaming, NFT, AI)
3. Pick features (anti-sniper, VRF, royalties, etc.)
4. Click "Generate"

You get:
- Contract.sol (production-ready)
- Test.sol (comprehensive tests)
- Security checklist (400+ checks)
- Deployment guide (KB-sourced)</code></pre>

                <h5 class="mt-4">3. Explore the KB</h5>
                <p>Use the <a href="/explore">Explore</a> page to browse by category.</p>
            </div>
        </div>

        <!-- Domains -->
        <div class="card mb-4">
            <div class="card-body">
                <h3><i class="fas fa-th-large"></i> Supported Domains</h3>

                <h5 class="mt-3"><i class="fas fa-coins text-warning"></i> DeFi</h5>
                <p><strong>Features:</strong> anti-sniper, slippage, oracle</p>
                <p><strong>Perfect for:</strong> Trading tokens, DEX integrations, staking</p>

                <h5 class="mt-3"><i class="fas fa-gamepad text-success"></i> Gaming</h5>
                <p><strong>Features:</strong> vrf, achievements, anti-cheat</p>
                <p><strong>Perfect for:</strong> Gaming NFTs, loot boxes, character progression</p>

                <h5 class="mt-3"><i class="fas fa-image text-info"></i> NFT</h5>
                <p><strong>Features:</strong> royalties, reveal, allowlist</p>
                <p><strong>Perfect for:</strong> PFP collections, art, memberships</p>

                <h5 class="mt-3"><i class="fas fa-robot text-primary"></i> AI</h5>
                <p><strong>Features:</strong> oracle, usage-tracking, payments</p>
                <p><strong>Perfect for:</strong> AI agents, oracle integration, metered usage</p>
            </div>
        </div>

        <!-- Security Features -->
        <div class="card mb-4">
            <div class="card-body">
                <h3><i class="fas fa-shield-alt"></i> Automatic Security</h3>
                <p>Every generated contract includes:</p>
                <div class="row">
                    <div class="col-md-6">
                        <ul>
                            <li><strong>ReentrancyGuard</strong> - Prevents The DAO ($60M)</li>
                            <li><strong>Access Control</strong> - Prevents Parity ($280M)</li>
                            <li><strong>Pausable</strong> - Emergency stop</li>
                            <li><strong>SafeERC20</strong> - Token operation safety</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <ul>
                            <li><strong>Custom Errors</strong> - 50% gas savings</li>
                            <li><strong>Storage Packing</strong> - 20-40% gas savings</li>
                            <li><strong>Immutable Variables</strong> - 21,000 gas per access</li>
                            <li><strong>Safe Math</strong> - Overflow protection</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Knowledge Graph -->
        <div class="card mb-4">
            <div class="card-body">
                <h3><i class="fas fa-project-diagram"></i> Knowledge Graph</h3>
                <p>The system uses a knowledge graph with:</p>
                <ul>
                    <li><strong>45 nodes</strong> - Vulnerabilities, Templates, DeepDives, Integrations</li>
                    <li><strong>16 relationships</strong> - PREVENTS, PAIRS_WITH, EXPLAINS, etc.</li>
                    <li><strong>Full-text search</strong> - Search across all entities</li>
                    <li><strong>Semantic queries</strong> - Find related content</li>
                </ul>

                <h5 class="mt-3">Query Examples:</h5>
                <pre><code>Search "reentrancy" → Finds all reentrancy-related entities
Search "uniswap v4" → Finds Uniswap V4 content
Filter vulnerabilities by severity → High/Critical/Medium
Filter by loss amount → $50M+ exploits</code></pre>
            </div>
        </div>

        <!-- API Reference -->
        <div class="card mb-4">
            <div class="card-body">
                <h3><i class="fas fa-code"></i> API Reference</h3>
                <p>The web app provides REST APIs for programmatic access:</p>

                <h5>Search</h5>
                <pre><code>POST /api/search
Body: {"query": "reentrancy", "limit": 10}
Returns: List of matching entities</code></pre>

                <h5>Vulnerabilities</h5>
                <pre><code>GET /api/vulnerabilities?severity=high&min_loss=50000000
Returns: Filtered vulnerability list</code></pre>

                <h5>Generate</h5>
                <pre><code>POST /api/generate
Body: {"type": "ERC721", "domain": "gaming", "features": "vrf,achievements"}
Returns: Generated contract files</code></pre>

                <h5>Statistics</h5>
                <pre><code>GET /api/statistics
Returns: Graph statistics (nodes, edges, distribution)</code></pre>
            </div>
        </div>

        <!-- Command Line -->
        <div class="card mb-4">
            <div class="card-body">
                <h3><i class="fas fa-terminal"></i> Command Line Tools</h3>
                <p>You can also use the command-line tools:</p>

                <h5>Query KB</h5>
                <pre><code>python scripts/cocoindex/query_kb.py
python scripts/cocoindex/query_kb.py search "reentrancy"
python scripts/cocoindex/query_kb.py vulns high</code></pre>

                <h5>Generate Contract</h5>
                <pre><code>python scripts/cocoindex/contract_builder_v2.py \
  --type ERC721 --domain gaming \
  --features vrf,achievements \
  --output my-contract/</code></pre>
            </div>
        </div>

        <!-- Resources -->
        <div class="card">
            <div class="card-body">
                <h3><i class="fas fa-link"></i> Resources</h3>
                <ul>
                    <li><a href="../KNOWLEDGE-GRAPH-INTEGRATION.md">Knowledge Graph Integration Guide</a></li>
                    <li><a href="../CONTRACT-GENERATOR-README.md">Contract Generator README</a></li>
                    <li><a href="../DOMAIN-EXAMPLES.md">Domain Examples</a></li>
                    <li><a href="https://github.com/imDev2023/safe-smart-contracts">GitHub Repository</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}
